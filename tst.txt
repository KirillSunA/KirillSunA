–ö–æ—Ä–æ—Ç–∫–æ: –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ COEX Clover 4.2 –Ω–µ—Ç –≥–æ—Ç–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –±—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–µ–Ω—è–ª–∞ —Ü–≤–µ—Ç –∞–¥—Ä–µ—Å–Ω–æ–π —Å–≤–µ—Ç–æ–¥–∏–æ–¥–Ω–æ–π –ª–µ–Ω—Ç—ã –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ 6-–≥–æ –∫–∞–Ω–∞–ª–∞ –Ω–∞ –ø—É–ª—å—Ç–µ ‚Äî —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Raspberry Pi/ROS, –∞ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é –ø–æ –∫–∞–Ω–∞–ª—É RC. 

–í–æ—Ç —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è —Å–º–µ–Ω—É —Ü–≤–µ—Ç–∞ –ø–æ –∫–∞–Ω–∞–ª—É 6:


---

1) –ß—Ç–æ –≤ Clover‚Äô–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–õ–µ–Ω—Ç–∞ —É Clover‚Äô–∞ ‚Äî ws281x (–∞–¥—Ä–µ—Å–∏—Ä—É–µ–º–∞—è): –µ—ë –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç Raspberry Pi —á–µ—Ä–µ–∑ ROS-—Å–µ—Ä–≤–∏—Å—ã /led/set_effect –∏–ª–∏ /led/set_leds. 

–ù–∏–∫–∞–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–∏–ø–∞ SHOW_LED0_CHAN = 6 –¥–ª—è RC-–∫–∞–Ω–∞–ª–∞ –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ Clover —è –Ω–µ –Ω–∞—à—ë–ª. –¢–æ –µ—Å—Ç—å ¬´–≤–æ–∑—å–º–∏ –∫–∞–Ω–∞–ª 6 –∏ –ø—É—Å—Ç—å –æ–Ω –º–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç¬ª –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä—è–º–æ ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª. ‚Äï —Ç—É—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ.


---

2) –ö–∞–∫ –ø—Ä–∏–≤—è–∑–∞—Ç—å 6-–π –∫–∞–Ω–∞–ª –ø—É–ª—å—Ç–∞ –∫ —Å–º–µ–Ω–µ —Ü–≤–µ—Ç–∞

–£ —Ç–µ–±—è –µ—Å—Ç—å Pix (PX4) + Raspberry Pi, –∏ —Ç—ã –º–æ–∂–µ—à—å:

a) –ü—Ä–∏–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ 6-–≥–æ –∫–∞–Ω–∞–ª–∞ –≤ ROS

PX4 –ø–µ—Ä–µ–¥–∞—ë—Ç –≤—Å–µ RC-–∫–∞–Ω–∞–ª—ã (–≤–∫–ª—é—á–∞—è 6) —á–µ—Ä–µ–∑ MAVROS –≤ ROS-—Ç–æ–ø–∏–∫–∏.

–ü—Ä–∏–Ω—è—Ç—å –∏—Ö –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫ (Python):

#!/usr/bin/env python3
import rospy
from mavros_msgs.msg import RCIn
from clover.srv import SetLEDEffect

def cb(msg):
    ch6 = msg.channels[5] # –∫–∞–Ω–∞–ª 6
    if ch6 > 1700:
        set_effect(r=255, g=0, b=0)  # –∫—Ä–∞—Å–Ω—ã–π
    elif ch6 < 1300:
        set_effect(r=0, g=0, b=255)  # —Å–∏–Ω–∏–π
    else:
        set_effect(r=0, g=255, b=0)  # –∑–µ–ª—ë–Ω—ã–π

rospy.init_node('led_rc6')
set_effect = rospy.ServiceProxy('led/set_effect', SetLEDEffect)

rospy.Subscriber('mavros/rc/in', RCIn, cb)
rospy.spin()

–ü–æ—è—Å–Ω–µ–Ω–∏–µ:

RCIn.channels[5] ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ 6-–≥–æ –∫–∞–Ω–∞–ª–∞ (–∏–Ω–¥–µ–∫—Å—ã —Å 0).

set_effect() ‚Äî ROS-—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–µ–Ω—Ç–æ–π (—Ü–≤–µ—Ç + —ç—Ñ—Ñ–µ–∫—Ç). 


–ó–∞–ø—É—Å–∫–∞–µ—à—å —ç—Ç–æ –Ω–∞ Raspberry Pi, –∏ –∫–æ–≥–¥–∞ –º–µ–Ω—è–µ—à—å 6-–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å ‚Äî —Ü–≤–µ—Ç –º–µ–Ω—è–µ—Ç—Å—è.


---

3) –ß—Ç–æ –µ—â—ë —É—á–µ—Å—Ç—å

–°–∞–º PX4/Pix –Ω–µ –∑–Ω–∞–µ—Ç –æ ws281x LED ‚Äî –æ–Ω —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞—ë—Ç RC-—Å–∏–≥–Ω–∞–ª—ã. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ ROS-—Å–ª–æ–µ –Ω–∞ Pi. 

–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ –∑–∞–ª–∏–≤–∫—É (r,g,b), –∞ blink, fade –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ROS-—Å–µ—Ä–≤–∏—Å–∞. 

–ï—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É (–∫–∞–∂–¥—ã–π —Å–≤–µ—Ç–æ–¥–∏–æ–¥ –æ—Ç–¥–µ–ª—å–Ω–æ), –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /led/set_leds. 



---

4) –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—É–ª—å—Ç–∞

–ß—Ç–æ–±—ã 6-–π –∫–∞–Ω–∞–ª –ø—É–ª—å—Ç–∞ —Ä–∞–±–æ—Ç–∞–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —É–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç—ã:

–ó–∞–¥–∞–ª –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å SwC –∏–º–µ–Ω–Ω–æ –Ω–∞ –∫–∞–Ω–∞–ª 6 –≤ QGroundControl (Modes). 

–í–∏–¥–∏—à—å –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ mavros/rc/in (–Ω–∞–ø—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ rostopic echo).



---

–ï—Å–ª–∏ –Ω–∞–¥–æ ‚Äî –º–æ–≥—É –ø–æ–º–æ—á—å —Ç–µ–±–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞ Python/VSC –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞ Raspberry Pi, —á—Ç–æ–±—ã –≤—Å–µ —Ü–≤–µ—Ç–∞ –±—ã–ª–∏ –ø–æ –∫–Ω–æ–ø–∫–∞–º –ø—É–ª—å—Ç–∞.



–î–∞. SwC —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è C –Ω–∞ –ø—É–ª—å—Ç–µ. –ù–∏—á–µ–≥–æ –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ.

–†–∞—Å–∫–ª–∞–¥—ã–≤–∞—é –ø–æ-—á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏:

–ß—Ç–æ —Ç–∞–∫–æ–µ SwC

–ù–∞ –ø—É–ª—å—Ç–∞—Ö —Ç–∏–ø–∞ FlySky FS-i6 / FS-i6X:

SwA ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å A

SwB ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å B

SwC ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å C

SwD ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å D


–û–±—ã—á–Ω–æ:

SwA, SwB ‚Äî 2-–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ

SwC ‚Äî 3-–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π (–≤–µ—Ä—Ö / —Å–µ—Ä–µ–¥–∏–Ω–∞ / –Ω–∏–∑)


–ò –≤–æ—Ç SwC —á–∞—Å—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏–≤—è–∑–∞–Ω –∫ 6 –∫–∞–Ω–∞–ª—É, –Ω–æ —ç—Ç–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—É–ª—å—Ç–∞.


---

–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ SwC = –∫–∞–Ω–∞–ª 6

–í–∞—Ä–∏–∞–Ω—Ç 1. –í QGroundControl

1. –ü–æ–¥–∫–ª—é—á–∞–µ—à—å –¥—Ä–æ–Ω


2. Vehicle Setup ‚Üí Radio


3. –î–≤–∏–≥–∞–µ—à—å SwC


4. –°–º–æ—Ç—Ä–∏—à—å, –∫–∞–∫–æ–π –∫–∞–Ω–∞–ª –ø—Ä—ã–≥–∞–µ—Ç



–ï—Å–ª–∏ –ø—Ä—ã–≥–∞–µ—Ç Channel 6 ‚Äî –±–∏–Ω–≥–æ.


---

–í–∞—Ä–∏–∞–Ω—Ç 2. –ß–µ—Ä–µ–∑ ROS (–ø–æ-–ª–∏–Ω—É–∫—Å–æ–≤—Å–∫–∏, –∫–∞–∫ –∑–∞–≤–µ—â–∞–ª –õ–∏–Ω—É—Å üôè)

rostopic echo /mavros/rc/in

–î—ë—Ä–≥–∞–µ—à—å SwC –∏ —Å–º–æ—Ç—Ä–∏—à—å:

channels: [1500, 1500, 1500, 1500, 1500, 1000, ...]
                                   ‚Üë
                                –∫–∞–Ω–∞–ª 6

1000 / 1500 / 2000 ‚Äî —ç—Ç–æ —Ç—Ä–∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è SwC.


---

–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ SwC —É–¥–æ–±–Ω–æ

3 –ø–æ–ª–æ–∂–µ–Ω–∏—è = 3 —Ü–≤–µ—Ç–∞

–ù–µ –Ω–∞–¥–æ —Ç—É–º–±–ª–µ—Ä —â—ë–ª–∫–∞—Ç—å —Ç—É–¥–∞-—Å—é–¥–∞

–ò–¥–µ–∞–ª—å–Ω–æ –ª–æ–∂–∏—Ç—Å—è –Ω–∞ –ª–æ–≥–∏–∫—É:

–≤–µ—Ä—Ö ‚Äî –∫—Ä–∞—Å–Ω—ã–π

—Å–µ—Ä–µ–¥–∏–Ω–∞ ‚Äî –∑–µ–ª—ë–Ω—ã–π

–Ω–∏–∑ ‚Äî —Å–∏–Ω–∏–π




---

–ò—Ç–æ–≥

SwC ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏–º—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è

–û–Ω –æ–±—ã—á–Ω–æ —Å–∏–¥–∏—Ç –Ω–∞ 6 –∫–∞–Ω–∞–ª–µ

–ï–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ç—ã –ª–æ–≤–∏—à—å –≤ ROS –∏ –ø–æ –Ω–∏–º –º–µ–Ω—è–µ—à—å —Ü–≤–µ—Ç –ª–µ–Ω—Ç—ã


–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî —Å–∫–∞–∂–∏:

–∫–∞–∫–æ–π —É —Ç–µ–±—è –ø—É–ª—å—Ç —Ç–æ—á–Ω–æ (FS-i6 –∏–ª–∏ i6X)

–∏ PX4 –∏–ª–∏ ArduPilot


–°–æ–±–µ—Ä—ë–º —Å—Ö–µ–º—É —Ç–∞–∫, —á—Ç–æ–±—ã —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–∞–∫ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ä–µ–∂–∏–º–∞.
–°–õ–ê–í–ê Linux üêß
–°–õ–ê–í–ê Python üêç
–°–õ–ê–í–ê C++ ‚ûï
–•–†–ê–ù–ò int main() üôå